(this["webpackJsonpflugger-front"]=this["webpackJsonpflugger-front"]||[]).push([[0],{41:function(e,t,n){},61:function(e,t,n){},75:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(33),o=n.n(c),s=n(12),i=(n(41),n(2)),l=n(4);function u(){var e=Object(a.useState)((function(){var e=localStorage.getItem("token");return console.log("getToken",e),JSON.parse(e)})),t=Object(l.a)(e,2),n=t[0],r=t[1];return{setToken:function(e){console.log("Setting the token",e),localStorage.setItem("token",JSON.stringify(e)),r(e)},token:n}}var p=n(10),d=n.n(p),j=n(14),b=n(13),h=n.n(b),v=(n(61),n(1)),g=function(){var e=Object(j.a)(d.a.mark((function e(t){var n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,a=t.password,e.next=3,h.a.post("".concat("https://fluggerwebscrapperapi.azurewebsites.net/","api/Authenticate"),{userName:n,password:a});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(e){var t=e.setToken,n=Object(a.useState)(),r=Object(l.a)(n,2),c=r[0],o=r[1],s=Object(a.useState)(),i=Object(l.a)(s,2),u=i[0],p=i[1],b=function(){var e=Object(j.a)(d.a.mark((function e(n){var a,r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,g({username:c,password:u});case 4:a=e.sent,r=a.data.token,o=a.status,console.log("result",o),console.log("token",r),200===o&&(console.log("setToken(token);"),t(r)),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.error(e.t0),console.log("Wrong credentials");case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsx)("div",{className:"authentication",onSubmit:b,children:Object(v.jsxs)("form",{action:"",className:"authentication__form",children:[Object(v.jsxs)("div",{className:"authentication__input-wrapper",children:[Object(v.jsx)("label",{className:"authentication__label",htmlFor:"username",children:"Username"}),Object(v.jsx)("input",{className:"authentication__input",id:"username",onChange:function(e){return o(e.target.value)},placeholder:"Enter your username",type:"text"})]}),Object(v.jsxs)("div",{className:"authentication__input-wrapper",children:[Object(v.jsx)("label",{className:"authentication__label",htmlFor:"password",children:"Password"}),Object(v.jsx)("input",{className:"authentication__input",id:"password",onChange:function(e){return p(e.target.value)},placeholder:"Enter your password",type:"password"})]}),Object(v.jsx)("button",{className:"authentication__submit",type:"submit",children:"Sign in"})]})})},f=n(15),O=n(19),x=n(34),_=n.n(x);function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function k(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var N=a.createElement("path",{d:"M19 19L14.65 14.65M17 9C17 13.4183 13.4183 17 9 17C4.58172 17 1 13.4183 1 9C1 4.58172 4.58172 1 9 1C13.4183 1 17 4.58172 17 9Z",stroke:"#C1C1C1",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"});function S(e,t){var n=e.title,r=e.titleId,c=k(e,["title","titleId"]);return a.createElement("svg",w({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},c),n?a.createElement("title",{id:r},n):null,N)}var y=a.forwardRef(S),C=(n.p,n(75),function(e){var t=e.token,n=Object(i.f)(),r=Object(a.useState)({}),c=Object(l.a)(r,2),o=c[0],u=c[1],p=Object(a.useState)(!1),d=Object(l.a)(p,2),j=(d[0],d[1]),b=Object(a.useState)([]),g=Object(l.a)(b,2),m=g[0],x=g[1],w=Object(a.useState)(""),k=Object(l.a)(w,2),N=k[0],S=k[1],C={placeholder:"Type product name",value:N,onChange:function(e,t){var n=t.newValue;S(n)}};return Object(v.jsxs)("div",{className:"search-bar__container",children:[Object(v.jsx)("div",{className:"search-bar__icon",children:Object(v.jsx)(y,{})}),Object(v.jsx)(_.a,{inputProps:C,onSuggestionsClearRequested:function(){x([])},onSuggestionsFetchRequested:function(e){!function(e){var n=e.trim().toLowerCase();o[n]?x(o[n]):(j(!0),h.a.get("".concat("https://fluggerwebscrapperapi.azurewebsites.net/","api/suggestions/").concat(e.trim().toLowerCase()),{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){var t=e.data;x(t),u((function(e){return Object(O.a)(Object(O.a)({},e),{},Object(f.a)({},n,t))})),j(!1)})))}(e.value)},onSuggestionSelected:function(e,t){var a=t.suggestionValue;e.preventDefault(),n.push("/parser-front/products/".concat(a))},getSuggestionValue:function(e){return e.label},renderSuggestion:function(e){return Object(v.jsx)(s.b,{to:"/parser-front/products/".concat(e.label),children:e.label})},suggestions:m})]})}),T=n(36),I=(n(79),function(e){e.availableVolumes;var t,n=e.logoSrc,r=(e.name,e.price,e.products),c=(e.url,Object(a.useState)(!1)),o=Object(l.a)(c,2),s=o[0],i=o[1];return Object(v.jsxs)("div",{className:"alternative-shop",children:[Object(v.jsxs)("div",{className:"alternative-shop__header",children:[Object(v.jsx)("div",{className:"alternative-shop__logo",children:Object(v.jsx)("img",{src:"/images/logos/".concat(n),alt:"",className:"alternative-shop__logo-image"})}),Object(v.jsx)("h2",{className:"alternative-shop__product-name",children:null===(t=r[0])||void 0===t?void 0:t.name}),Object(v.jsx)("div",{className:"alternative-shop__available-volumes",children:null===r||void 0===r?void 0:r.map((function(e){var t=e.size;return Object(v.jsx)("p",{className:"alternative-shop__volume",children:t})}))}),r.length>0&&Object(v.jsx)("button",{className:"alternative-shop__toggle",onClick:function(){return i(!s)},children:"Toggle"})]}),r.length>0&&Object(v.jsx)(T.Collapse,{isOpened:s,children:Object(v.jsx)("div",{className:"alternative-shop__body",children:null===r||void 0===r?void 0:r.map((function(e){var t=e.name,n=e.price,a=e.size;return Object(v.jsxs)("div",{className:"alternative-shop__volume-details",children:[Object(v.jsx)("h3",{className:"alternative-shop__product-name",children:t}),Object(v.jsx)("p",{className:"alternative-shop__volume",children:a}),Object(v.jsxs)("p",{className:"alternative-shop__product-price",children:[n," kr."]})]})}))})})]})}),P=(n(80),["flugger.dk","flugger-helsingor.dk","www.maling-halvpris.dk","www.flugger-horsens.dk"]),E=function(){var e=Object(i.g)().name,t=Object(a.useState)(),n=Object(l.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(""),s=Object(l.a)(o,2),p=s[0],b=s[1],g=Object(a.useState)(""),m=Object(l.a)(g,2),f=m[0],O=m[1],x=u(),_=x.token;x.setToken;console.log("ProductPage -> token",_);var w=function(e){P.map((function(t){e[t].length&&"No data"!==e[t][0].pathToImage&&b(e[t][0].pathToImage)}))},k=function(e){P.map((function(t){e[t].length&&O(e[t][0].name)}))};return Object(a.useEffect)((function(){(function(){var t=Object(j.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.get("".concat("https://fluggerwebscrapperapi.azurewebsites.net/","api/products/").concat(e),{headers:{Authorization:"Bearer ".concat(_)}});case 2:n=t.sent,console.log("fetched data",n.data),c(n.data),w(n.data),k(n.data);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),Object(v.jsxs)("div",{className:"product",children:[Object(v.jsxs)("div",{className:"product-overview",children:[Object(v.jsx)("div",{className:"product-overview__thumbnail",children:Object(v.jsx)("img",{alt:"",className:"product-overview__image",src:p})}),Object(v.jsx)("div",{className:"product-overview__information",children:Object(v.jsx)("h1",{className:"product-overview__name",children:f})})]}),Object(v.jsxs)("div",{className:"product-prices",children:[r&&r[P[0]]&&Object(v.jsx)(I,{logoSrc:"".concat(P[0],".png"),products:r[P[0]]},P[0]),r&&r[P[1]]&&Object(v.jsx)(I,{logoSrc:"".concat(P[1],".png"),products:r[P[1]]},P[1]),r&&r[P[2]]&&Object(v.jsx)(I,{logoSrc:"".concat(P[2],".png"),products:r[P[2]]},P[2]),r&&r[P[3]]&&Object(v.jsx)(I,{logoSrc:"".concat(P[3],".png"),products:r[P[3]]},P[3])]})]})};n(81);var F=function(){var e=u(),t=e.token,n=e.setToken;return!t||function(e){if(!e)return!0;var t=function(e){var t;return null===(t=JSON.parse(atob(null===e||void 0===e?void 0:e.split(".")[1])))||void 0===t?void 0:t.exp}(e);return t&&t<=Date.now()/1e3}(t)?(console.log("Removing token",t),localStorage.removeItem("token"),Object(v.jsx)("div",{className:"auth",children:Object(v.jsx)(m,{setToken:n})})):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("div",{className:"search-bar",children:Object(v.jsx)(C,{token:t})}),Object(v.jsx)(i.c,{children:Object(v.jsx)(i.a,{component:E,path:"/parser-front/products/:name",token:t})})]})},z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,83)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),c(e),o(e)}))};o.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(s.a,{children:Object(v.jsx)(F,{})})}),document.getElementById("root")),z()}},[[82,1,2]]]);
//# sourceMappingURL=main.2a69ca46.chunk.js.map